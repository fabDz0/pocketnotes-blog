<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>ExploringOTP | pocketnotes</title>
<meta name="keywords" content="otp, python, how-to, notes, totp, hotp">
<meta name="description" content="
What is second factor authentication?  The code which we enter after entering username and password, how does this work ?
In this blog post will be exploring how one time password/passcode (OTP) works. Will start with what is included in standard on OTP and then implementing this using python code.">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/posts/exploringotp/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.da3211e5ef867bf2b75fd5a6515cfed7195c011e8ab735694e203810a827097b.css" integrity="sha256-2jIR5e&#43;Ge/K3X9WmUVz&#43;1xlcAR6KtzVpTiA4EKgnCXs=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/favicon/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/favicon/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/exploringotp/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="pocketnotes (Alt + H)">pocketnotes</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/archives/" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      ExploringOTP
    </h1>
    <div class="post-meta"><span title='2020-06-29 09:18:25 +0530 IST'>June 29, 2020</span>&nbsp;·&nbsp;<span>5 min</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#rfc-note" aria-label="RFC note">RFC note</a></li>
                <li>
                    <a href="#10000-feet-view" aria-label="10000 Feet View">10000 Feet View</a></li>
                <li>
                    <a href="#implementation-details" aria-label="Implementation Details">Implementation Details</a></li>
                <li>
                    <a href="#implementing-otp-using-python" aria-label="Implementing OTP using python">Implementing OTP using python</a><ul>
                        
                <li>
                    <a href="#demo-on-totp-" aria-label="Demo on TOTP ,">Demo on TOTP ,</a></li>
                <li>
                    <a href="#generate-unique-code" aria-label="Generate unique code">Generate unique code</a></li>
                <li>
                    <a href="#servercode-to-validate" aria-label="ServerCode to Validate">ServerCode to Validate</a></li></ul>
                </li>
                <li>
                    <a href="#validate-code-in-authenticator-app-using-this-script---servercode-to-validate" aria-label="Validate code in authenticator app using this script -&gt; Servercode to validate">Validate code in authenticator app using this script -&gt; Servercode to validate</a></li>
                <li>
                    <a href="#references" aria-label="References">References</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p><img alt="SecretShared" loading="lazy" src="/img/otpWorks.jpg"></p>
<p>What is second factor authentication?  The code which we enter after entering username and password, how does this work ?</p>
<p>In this blog post will be exploring how one time password/passcode (OTP) works. Will start with what is included in standard on OTP and then implementing this using python code.</p>
<hr>
<h2 id="rfc-note">RFC note<a hidden class="anchor" aria-hidden="true" href="#rfc-note">#</a></h2>
<p>Two major OTP implementations are defined in RFC. HOTP as described in <a href="https://tools.ietf.org/html/rfc4226">RFC4226</a> and TOTP described in <a href="https://tools.ietf.org/html/rfc6238">RFC6238</a>.
<strong>HOTP</strong> - HMAC based one time password</p>
<ul>
<li>Code is generated at server end only</li>
<li>When prompted for OTP, the code is sent to user(SMS/Email).
<strong>TOTP</strong> - Time based one time password</li>
<li>Code is generated at user end and server.Time is used as counter here.</li>
<li>When prompted for OTP, the code generated at user end is verified against the code generated at server end. Avoids storing mobile numbers at server end to send SMS.</li>
</ul>
<hr>
<h2 id="10000-feet-view">10000 Feet View<a hidden class="anchor" aria-hidden="true" href="#10000-feet-view">#</a></h2>
<p><img alt="OTP overview" loading="lazy" src="/img/otp10000.jpg">
When someone signs up for OTP, a secret is shared with user, as a barcode or as a text. This text/barcode is added to a authenticator app(Authy, Google Authenticator etc). App generates a unique code which is in sync with code generated at server. When user enters the code, this is validated at server and if its a match, Access granted!!.</p>
<hr>
<h2 id="implementation-details">Implementation Details<a hidden class="anchor" aria-hidden="true" href="#implementation-details">#</a></h2>
<p><img alt="SecretShared" loading="lazy" src="/img/otpWorks.jpg">
Let&rsquo;s explore how HOTP and TOTP is implemented according to RFC&rsquo;s.
HOTP uses HMAC -SHA1 algorithm to generate random string. This random string is truncated so that it&rsquo;s suitable for use.</p>
<p><em>How HOTP validates code</em>, given a secret
HOTP(K,C) = Truncate(HMAC-SHA-1(K,C))
<strong>C</strong> - 8bit counter
<strong>K</strong> - Shared secret between client and server
The HOTP value is truncated so that it can be used as one time password.
<strong>OTP</strong> = { HOTP modulo (10^ Digits)}
<strong>Digits</strong> - number of digits in OTP
<a href="https://tools.ietf.org/html/rfc4226#section-5.4">Check this Example code in RFC</a></p>
<p><em>How TOTP validates code,</em> The main difference here, is that &ldquo;Time&rdquo; is used as counter. Unixtime is used as counter. Idea of using unix time is avoid errors due to timezone. <em>Unixtime</em> is the number of seconds elapsed since midnight UTC of January 1, 1970.</p>
<blockquote>
<p><strong>Example</strong>: Unixtime for 26 July 2020 11:30:30 is 1595763030. Time counter in TOTP changes every 30 seconds. Value &lsquo;30&rsquo; is defined in RFC. This is a balance between usuability and security. So that user does not wait too long for a new code or attacker is given enough time to brute force codes.</p>
</blockquote>
<ul>
<li><strong>Counter</strong> = T = (Current Unixtime - T0 /X)</li>
<li><strong>T0</strong> is the Unix time to start counting time steps (default value is 0, i.e., the Unix epoch) <a href="https://tools.ietf.org/html/rfc6238#section-4.1">RFC 6238</a></li>
<li><strong>X</strong> represents the time step in seconds (default value X = 30 seconds)(RFC reference)<a href="https://tools.ietf.org/html/rfc6238#section-4.1">RFC 6238</a>.
This ensures OTP changes every 30 seconds.  TOTP uses HOTP algorithm as basic building block,</li>
</ul>
<blockquote>
<p><strong>TOTP = HOTP {K,T}</strong>.<br>
<strong>K</strong> - secret key<br>
<strong>T</strong> - Counter</p>
</blockquote>
<p><img alt="OTPFLOW" loading="lazy" src="/img/otpFlow.jpg"></p>
<p>To summarise,</p>
<blockquote>
<p>When a user is prompted to enter OTP, code from authenticator app is entered. This is sent to server. Remember this code is generated with current unixtime on user device and sent to server. Now at server end, the code is generated based on current unixtime at server and compared with code sent by client. There may be some time lag between the time when code is generated at client and time when code is generated at server. This should be within 30 seconds.</p>
</blockquote>
<hr>
<h2 id="implementing-otp-using-python">Implementing OTP using python<a hidden class="anchor" aria-hidden="true" href="#implementing-otp-using-python">#</a></h2>
<p>There is a python module which implements OTP as per RFC.<br>
pyOTP is a python implementation of OTP according to <a href="https://tools.ietf.org/html/rfc4226">RFC4226</a> and <a href="https://tools.ietf.org/html/rfc6238">RFC6238</a>.</p>
<p><a href="https://github.com/pyauth/pyotp">PyOTP</a></p>
<h3 id="demo-on-totp-">Demo on TOTP ,<a hidden class="anchor" aria-hidden="true" href="#demo-on-totp-">#</a></h3>
<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/vBntD8XMHkc?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"></iframe>
    </div>

<p><br>
Let&rsquo;s explore how we can use pyotp to implement this.</p>
<h3 id="generate-unique-code">Generate unique code<a hidden class="anchor" aria-hidden="true" href="#generate-unique-code">#</a></h3>
<ul>
<li><strong>Generate unique code</strong>, using pyotp we can generate random string and share this with user OR generate a barcode using <a href="https://github.com/neocotic/qrious">QR Code generator</a> and share. Then user can scan or add Secret code to authenticator apps like Google Authenticator, Authy.</li>
</ul>
<p>Below is a sample code which generates secret string, gives an output which can be used to generate barcode and shows how HOTP codes are generated with counter.
<img alt="code1" loading="lazy" src="/img/otpSampleCode.png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pyotp
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>SecureString <span style="color:#f92672">=</span> pyotp<span style="color:#f92672">.</span>random_base32()
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Generate secure string to be shared with user</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>key <span style="color:#f92672">=</span> pyotp<span style="color:#f92672">.</span>TOTP(SecureString)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>a<span style="color:#f92672">=</span>pyotp<span style="color:#f92672">.</span>totp<span style="color:#f92672">.</span>TOTP(SecureString)<span style="color:#f92672">.</span>provisioning_uri(name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;batman@google.com&#39;</span>, issuer_name<span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;NotesOTP&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Convert unique string to barcode, output will be used in QRious to generate QR code.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34; Secure Code is: &#34;</span>, SecureString)
</span></span><span style="display:flex;"><span>print (<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74"> For QR Code use this --&gt;: &#34;</span>, a)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74"> TOTP is : &#34;</span>,key<span style="color:#f92672">.</span>now())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Counter based OTP - HOTP</span>
</span></span><span style="display:flex;"><span>SecureString_H <span style="color:#f92672">=</span> pyotp<span style="color:#f92672">.</span>random_base32()
</span></span><span style="display:flex;"><span>key_hotp <span style="color:#f92672">=</span> pyotp<span style="color:#f92672">.</span>HOTP(SecureString)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74"> HOTP at 0 :&#34;</span>, key_hotp<span style="color:#f92672">.</span>at(<span style="color:#ae81ff">0</span>))
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74"> HOTP at 1 :&#34;</span>, key_hotp<span style="color:#f92672">.</span>at(<span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74"> HOTP at 2 :&#34;</span>, key_hotp<span style="color:#f92672">.</span>at(<span style="color:#ae81ff">2</span>))
</span></span></code></pre></div><p><em>Output of this code</em>
<img alt="Output" loading="lazy" src="/img/otpCodeOutput.png"></p>
<h3 id="servercode-to-validate">ServerCode to Validate<a hidden class="anchor" aria-hidden="true" href="#servercode-to-validate">#</a></h3>
<ul>
<li>ServerCode to Validate( <em>this is not how server validates, but to make it simple a small python script will simulate code generated at server to see if both OTP&rsquo;s are in sync</em>), ideal flow would be like this, When client sends a TOTP to server, server retrieves secret for user and generates TOTP at server based on current unix time. This TOTP is compared with TOTP sent by client. As you can see, time difference plays a major role in sync 30seconds should compensate delays. Anything beyond this will start increasing attack surface for brute force attacks.</li>
</ul>
<p><img alt="OTP_code" loading="lazy" src="/img/otpValidate.png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pyotp
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> time
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Server code to validate</span>
</span></span><span style="display:flex;"><span>key <span style="color:#f92672">=</span> pyotp<span style="color:#f92672">.</span>TOTP(<span style="color:#e6db74">&#39;ENXXHOWWQ425QHJZ&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span>(<span style="color:#66d9ef">True</span>):
</span></span><span style="display:flex;"><span>    otp <span style="color:#f92672">=</span> key<span style="color:#f92672">.</span>now()
</span></span><span style="display:flex;"><span>    localtime <span style="color:#f92672">=</span> time<span style="color:#f92672">.</span>localtime()
</span></span><span style="display:flex;"><span>    result <span style="color:#f92672">=</span> time<span style="color:#f92672">.</span>strftime(<span style="color:#e6db74">&#34;%I:%M:%S %p&#34;</span>, localtime)
</span></span><span style="display:flex;"><span>    print(result, otp, end<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>, flush<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\r</span><span style="color:#e6db74">&#34;</span>, end<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>, flush<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>    time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">1</span>)
</span></span></code></pre></div><p>Once we have these two scripts, lets generate QR code ,
Go ahead and scan this,
<img alt="QRCode" loading="lazy" src="/img/otpQR.png#center"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">--</span>snip<span style="color:#f92672">--</span>
</span></span><span style="display:flex;"><span>a<span style="color:#f92672">=</span>pyotp<span style="color:#f92672">.</span>totp<span style="color:#f92672">.</span>TOTP(SecureString)<span style="color:#f92672">.</span>provisioning_uri(name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;batman@google.com&#39;</span>, issuer_name<span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;NotesOTP&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Output</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> print (a)
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> otpauth:<span style="color:#f92672">//</span>totp<span style="color:#f92672">/</span>NotesOTP:batman<span style="color:#f92672">%</span><span style="color:#ae81ff">40</span>google<span style="color:#f92672">.</span>com secret<span style="color:#f92672">=</span>ENXXHOWWQ425QHJZ<span style="color:#f92672">&amp;</span>issuer<span style="color:#f92672">=</span>NotesOTP
</span></span></code></pre></div><p>Scan Code with an authenticator app on phone
<img alt="Scan Code" loading="lazy" src="/img/otpScanCode.png"></p>
<p>Code Sync
<img alt="Sync_01" loading="lazy" src="/img/otpCodeSync.png"></p>
<p>Second Code Sync
<img alt="sync_02" loading="lazy" src="/img/otpCodeSync2.png"></p>
<h2 id="validate-code-in-authenticator-app-using-this-script---servercode-to-validate">Validate code in authenticator app using this script -&gt; <a href="#servercode-to-validate">Servercode to validate</a><a hidden class="anchor" aria-hidden="true" href="#validate-code-in-authenticator-app-using-this-script---servercode-to-validate">#</a></h2>
<h2 id="references">References<a hidden class="anchor" aria-hidden="true" href="#references">#</a></h2>
<ul>
<li><a href="https://www.freecodecamp.org/news/how-time-based-one-time-passwords-work-and-why-you-should-use-them-in-your-app-fdd2b9ed43c3/">How time based OTP works</a></li>
<li><a href="https://github.com/pyauth/pyotp">PyOTP</a></li>
<li><a href="https://pypi.org/project/authenticator/">Authenticator</a></li>
<li><a href="https://tools.ietf.org/html/rfc4226">RFC 4226</a></li>
<li><a href="https://tools.ietf.org/html/rfc6238">RFC 6238</a></li>
<li><a href="https://www.unixtimestamp.com/index.php">UnixTimeStamp</a></li>
<li><a href="https://github.com/neocotic/qrious">QR Code generator</a></li>
</ul>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/otp/">Otp</a></li>
      <li><a href="http://localhost:1313/tags/python/">Python</a></li>
      <li><a href="http://localhost:1313/tags/how-to/">How-To</a></li>
      <li><a href="http://localhost:1313/tags/notes/">Notes</a></li>
      <li><a href="http://localhost:1313/tags/totp/">Totp</a></li>
      <li><a href="http://localhost:1313/tags/hotp/">Hotp</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/posts/starthere/">
    <span class="title">« Prev</span>
    <br>
    <span>StartHere</span>
  </a>
  <a class="next" href="http://localhost:1313/posts/diamond_wanncry/">
    <span class="title">Next »</span>
    <br>
    <span>Analyze WannaCry Ransomware with Diamond Model</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="http://localhost:1313/">pocketnotes</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
