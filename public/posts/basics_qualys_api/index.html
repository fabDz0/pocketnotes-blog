<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Qualys API basics | pocketnotes</title>
<meta name="keywords" content="Qualys, API, PowerShell, how-to">
<meta name="description" content="Basics of Qualys API
Introduction
Qualys has published a detailed guide on using API. Primarily this blog will concentrate on &ldquo;cURL&rdquo; and &ldquo;PowerShell&rdquo; as the scripting language to query the API.

Note on API limits:
Qualys has applied rate limit on API calls based on subscription.
Reading API limit is easy, look for X-Powered-By header in http-reponse headers,
X-RateLimit-Limit: API calls limit
X-RateLimit-Window-Sec:/60*60&quot; hrs.
Ex:  if &ldquo;X-RateLimit-Limit: 100&rdquo;
&ldquo;X-RateLimit-Window-Sec: 86400&rdquo;\

Then,">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/posts/basics_qualys_api/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.da3211e5ef867bf2b75fd5a6515cfed7195c011e8ab735694e203810a827097b.css" integrity="sha256-2jIR5e&#43;Ge/K3X9WmUVz&#43;1xlcAR6KtzVpTiA4EKgnCXs=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/favicon/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/favicon/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/basics_qualys_api/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="pocketnotes (Alt + H)">pocketnotes</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/archives/" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Qualys API basics
    </h1>
    <div class="post-meta"><span title='2019-05-27 08:08:19 +0530 IST'>May 27, 2019</span>&nbsp;·&nbsp;<span>3 min</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#basics-of-qualys-api" aria-label="Basics of Qualys API">Basics of Qualys API</a><ul>
                        <ul>
                        
                <li>
                    <a href="#introduction" aria-label="Introduction">Introduction</a></li>
                <li>
                    <a href="#getting-started" aria-label="Getting Started">Getting Started</a><ul>
                        
                <li>
                    <a href="#establish-connection-using-curl" aria-label="Establish connection using cURL">Establish connection using cURL</a></li>
                <li>
                    <a href="#establish-connection-with-powershell" aria-label="Establish Connection with PowerShell">Establish Connection with PowerShell</a></li>
                <li>
                    <a href="#request-to-get-asset-records" aria-label="Request to get Asset records">Request to get Asset records</a>
                </li>
            </ul>
            </ul>
            </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="basics-of-qualys-api">Basics of Qualys API<a hidden class="anchor" aria-hidden="true" href="#basics-of-qualys-api">#</a></h1>
<h3 id="introduction">Introduction<a hidden class="anchor" aria-hidden="true" href="#introduction">#</a></h3>
<p>Qualys has published a detailed guide on using <a href="https://www.qualys.com/docs/qualys-api-vmpc-user-guide.pdf">API</a>. Primarily this blog will concentrate on &ldquo;cURL&rdquo; and &ldquo;PowerShell&rdquo; as the scripting language to query the API.</p>
<blockquote>
<p><strong>Note on API limits:</strong>
Qualys has applied rate limit on API calls based on subscription.
Reading API limit is easy, look for <em>X-Powered-By</em> header in http-reponse headers,<br>
<strong>X-RateLimit-Limit:</strong> API calls limit<br>
<strong>X-RateLimit-Window-Sec:/60*60</strong>&quot; hrs.<br>
Ex:  if &ldquo;X-RateLimit-Limit: 100&rdquo;<br>
&ldquo;X-RateLimit-Window-Sec: 86400&rdquo;\</p>
</blockquote>
<p>Then,</p>
<p><strong>100</strong> API calls every (86400/3600) 24 hrs.</p>
<p>To check API call limit,</p>
<pre tabindex="0"><code class="language-curl" data-lang="curl">c:\ curl -s -I -D header.txt -u username:password --insecure &#34;https://qualysapi.qualys.com/msp/about.php&#34;
</code></pre><p>More about API limit is available in this <a href="https://discussions.qualys.com/thread/2064">thread</a>.</p>
<h3 id="getting-started">Getting Started<a hidden class="anchor" aria-hidden="true" href="#getting-started">#</a></h3>
<p>Qualys support REST API calls to query data, these calls has to be an authenticated call. Currently as per the documentation both basic all well as session based authentication is supported. Qualys URL&rsquo;s used here are based on a certain <a href="https://community.qualys.com/docs/DOC-4172-identify-your-qualys-platform">platform</a>. Change this based on your subscription.</p>
<h4 id="establish-connection-using-curl">Establish connection using cURL<a hidden class="anchor" aria-hidden="true" href="#establish-connection-using-curl">#</a></h4>
<p>Basic Authentication no session is established. &ldquo;<em>cURL</em> connects and collects the data requested for.</p>
<ul>
<li>-H &ldquo;X-Requested-With: Curl&rdquo;   &ndash;&gt; &ldquo;X-requested-with&rdquo; is mandatory\</li>
<li>-u &ldquo;username:password&rdquo;        &ndash;&gt; Qualys username and password\</li>
<li>&ldquo;- -insecure&rdquo;                    &ndash;&gt; for bypassing certificate errors while connecting</li>
</ul>
<pre tabindex="0"><code class="language-curl" data-lang="curl">curl -H &#34;X-Requested-With: Curl &#34; -X &#34;POST&#34; -F truncation_limit=10 -u &#34;username:password&#34; --insecure &#34;https://qualysapi.qg2.apps.qualys.com/api/2.0/fo/asset/host/?action=list&#34;
</code></pre><p><em>truncation_limit</em>  defines the count of records to fetch. By default 1000 records are fetched.<br>
The basic URL - <code>https://qualysapi.qg2.apps.qualys.com/api/2.0/fo/</code> remains same. Based on resources queried the URL changes after this basic URL.</p>
<p><code>https://qualysapi.qg2.apps.qualys.com/api/2.0/fo/scan/?action=list</code>
This gives list of VM scans performed in last 30 days.</p>
<!-- raw HTML omitted -->
<h4 id="establish-connection-with-powershell">Establish Connection with PowerShell<a hidden class="anchor" aria-hidden="true" href="#establish-connection-with-powershell">#</a></h4>
<p>This script will prompt user for username and password and set headers.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>$username = Read-Host <span style="color:#e6db74">&#34;Enter username&#34;</span>
</span></span><span style="display:flex;"><span>$password = Read-Host <span style="color:#e6db74">&#34;Enter password&#34;</span>
</span></span><span style="display:flex;"><span>$headerValue = @{<span style="color:#e6db74">&#34;X-Requested-With&#34;</span>=<span style="color:#e6db74">&#34;PowerShell&#34;</span>}
</span></span></code></pre></div><p>Setting basic URL to a variable, and setting content of body for powershell request</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>$basicURL = <span style="color:#e6db74">&#34;https://qualysapi.qg2.apps.qualys.com/api/2.0/fo/&#34;</span>
</span></span><span style="display:flex;"><span>$body = <span style="color:#e6db74">&#34;action=login&amp;username=</span>$username<span style="color:#e6db74">&amp;password=</span>$password<span style="color:#e6db74">&#34;</span>
</span></span></code></pre></div><p><strong>Make requests</strong>
Will use <em>Invoke-RestMethod</em> cmdlet to query the API.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Invoke-RestMethod -Headers $headerValue -Uri <span style="color:#e6db74">&#34;</span>$basicURL<span style="color:#e6db74">/session&#34;</span> -Method Post -Body $body -SessionVariable sessionValue
</span></span></code></pre></div><p>-Uri &ndash;&gt; URL to send the query
-Method &ndash;&gt; method to be used to send the query (POST here)</p>
<ul>
<li>SessionVariable &ndash;&gt; Store contents of session to a variable (sessionValue is the variable here)
-Body &ndash;&gt; content of body to be send in query</li>
</ul>
<p>This will establish connection and <code>$sessionValue</code> can be reused when new requests are made.</p>
<h4 id="request-to-get-asset-records">Request to get Asset records<a hidden class="anchor" aria-hidden="true" href="#request-to-get-asset-records">#</a></h4>
<p>Putting it together, this script will get list of assets from Qualys using API. Count of assets depends on <em>&ldquo;truncation limit&rdquo;</em> header</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#75715e">#Set initial parameters</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Additional parameter here is *truncation_limit*, this sets the limit of records to be fetched. Used especially while querying for asset records.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$username = Read-Host <span style="color:#e6db74">&#34;Enter username&#34;</span>
</span></span><span style="display:flex;"><span>$password = Read-Host <span style="color:#e6db74">&#34;Enter password&#34;</span>
</span></span><span style="display:flex;"><span>$headerValue = @{<span style="color:#e6db74">&#34;X-Requested-With&#34;</span>=<span style="color:#e6db74">&#34;PowerShell&#34;</span>,<span style="color:#e6db74">&#34;truncation_limit=10&#34;</span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Set URL and content of body</span>
</span></span><span style="display:flex;"><span>$basicURL = <span style="color:#e6db74">&#34;https://qualysapi.qg2.apps.qualys.com/api/2.0/fo/&#34;</span>
</span></span><span style="display:flex;"><span>$body = <span style="color:#e6db74">&#34;action=login&amp;username=</span>$username<span style="color:#e6db74">&amp;password=</span>$password<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#make request to get asset records</span>
</span></span><span style="display:flex;"><span>Invoke-RestMethod -Headers $headerValue -Method Post -Body $body 
</span></span><span style="display:flex;"><span>-WebSession $sessionValue -Uri <span style="color:#e6db74">&#34;</span>$basicURL<span style="color:#e6db74">/asset/host/?action=list&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># logout of session</span>
</span></span><span style="display:flex;"><span>Invoke-RestMethod -Headers $headerValue -Method Post -WebSession $sessionValue -Uri <span style="color:#e6db74">&#34;</span>$basicURL<span style="color:#e6db74">/session/?action=logout&#34;</span>
</span></span></code></pre></div><!-- raw HTML omitted -->

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/qualys/">Qualys</a></li>
      <li><a href="http://localhost:1313/tags/api/">API</a></li>
      <li><a href="http://localhost:1313/tags/powershell/">PowerShell</a></li>
      <li><a href="http://localhost:1313/tags/how-to/">How-To</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/posts/folderpath_filename/">
    <span class="title">« Prev</span>
    <br>
    <span> FolderPaths and FilesNames - PowerShell</span>
  </a>
  <a class="next" href="http://localhost:1313/posts/rdp_mitm_demo/">
    <span class="title">Next »</span>
    <br>
    <span>RDP MitM Demo</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="http://localhost:1313/">pocketnotes</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
